(()=>{"use strict";function t(){return{addTaskButton:function(){const t=document.querySelector(".button-add-task"),e=document.querySelector(".add-task-popup");t.addEventListener("click",(()=>{e.style.display="block"})),document.querySelector(".button-cancel-task-popup").addEventListener("click",(()=>{e.style.display="none"}))},addProjectButton:function(){const t=document.getElementById("project-btn"),e=document.querySelector(".projectInputDiv");t.addEventListener("click",(()=>{e.style.display="block"})),document.getElementById("project-button-cancel").addEventListener("click",(()=>{e.style.display="none"}))}}}t().addTaskButton(),t().addProjectButton(),function(){const t=document.querySelector("[data-lists]"),e=document.querySelector("[data-new-list-form]"),a=document.querySelector("[data-new-list-input]"),n=document.querySelector("[data-list-display-container]"),d=document.querySelector("[data-list-title]"),s=document.querySelector("[data-list-count]"),i=document.querySelector("[data-tasks]"),c=document.querySelector("[data-new-task-form]"),l=document.querySelector("[data-new-task-input]"),o="task.lists",r="task.selectedListId";let u=JSON.parse(localStorage.getItem(o))||[],p=localStorage.getItem(r);function m(){localStorage.setItem(o,JSON.stringify(u)),localStorage.setItem(r,p)}function k(){y(t),u.forEach((e=>{const a=document.createElement("li"),n=document.createElement("i");n.classList.add("fa","fa-times","xProject"),n.setAttribute("data-delete-list-button",e.id),a.dataset.listId=e.id,a.classList.add("button-project"),a.innerHTML=`<i class="fa fa-tasks" aria-hidden="true"></i>${e.name}`,e.id===p&&a.classList.add("active-list"),a.appendChild(n),t.appendChild(a)}));const e=u.find((t=>t.id===p));null==p?n.style.display="none":(n.style.display="",d.innerText=e.name,f(e),y(i),function(t){t.tasks.forEach((t=>{const e=document.createElement("div");e.classList.add("task-button"),!0===t.complete?(document.getElementById(t.id),e.innerHTML=`\n                    <div class="leftSide-task">\n                            <input class="checkIt" type="checkbox" checked=true id=${t.id} data-check-box>\n                            <p class="task-content">${t.name}</p>\n                            <input type="text" class="input-task-name" data-input-task-name>\n                        </div>\n\n                        <div class="rightSide-task">\n                            <p class="due-date" id="due-date"></p>\n                            <input type="date" class="input-due-date" data-input-due-date>\n                            <i class="fa fa-times xTask" data-delete-task-list=${t.id} aria-hidden="true"></i>\n                        </div>\n                    `):e.innerHTML=`\n                    <div class="leftSide-task">\n                            <input class="checkIt" type="checkbox" id=${t.id} data-check-box>\n                            <p class="task-content">${t.name}</p>\n                            <input type="text" class="input-task-name" data-input-task-name>\n                        </div>\n    \n                        <div class="rightSide-task">\n                            <p class="due-date" id="due-date"></p>\n                            <input type="date" class="input-due-date" data-input-due-date>\n                            <i class="fa fa-times xTask" data-delete-task-list=${t.id} aria-hidden="true"></i>\n                        </div>\n                    `,i.appendChild(e)}))}(e))}function f(t){const e=t.tasks.filter((t=>!t.complete)).length;s.innerText=e}function y(t){for(;t.firstChild;)t.removeChild(t.firstChild)}t.addEventListener("click",(t=>{"li"===t.target.tagName.toLowerCase()&&(p=t.target.dataset.listId,m(),k()),"i"===t.target.tagName.toLowerCase()&&(u=u.filter((e=>e.id!==t.target.dataset.deleteListButton)),p=null,m(),k())})),i.addEventListener("click",(t=>{if("input"===t.target.tagName.toLowerCase()){const e=u.find((t=>t.id===p));e.tasks.find((e=>e.id===t.target.id)).complete=t.target.checked,m(),f(e)}if("i"===t.target.tagName.toLowerCase()){const e=u.find((t=>t.id===p));e.tasks=e.tasks.filter((e=>e.id!==t.target.dataset.deleteTaskList)),m(),k()}})),e.addEventListener("submit",(t=>{t.preventDefault();const e=a.value;if(null==e||""===e)return;const n=(d=e,{id:Math.floor(1e6*Math.random()).toString(),name:d,tasks:[]});var d;a.value=null,u.push(n),m(),k()})),c.addEventListener("submit",(t=>{t.preventDefault();const e=l.value;if(null==e||""===e)return;const a=(n=e,{id:Math.floor(1e5*Math.random()).toString(),name:n,complete:!1});var n;l.value=null,u.find((t=>t.id===p)).tasks.push(a),m(),k()})),k()}()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QXNCakIsQ0FBRTlCLEdBQUlnQyxLQUFLQyxNQUFzQixJQUFoQkQsS0FBS0UsVUFBb0JDLFdBQVkvQixLQUFNQSxFQUFNTSxNQUFPLEtBRHBGLElBQW9CTixFQXBCaEJoQyxFQUFhMkQsTUFBUSxLQUNyQmxELEVBQU11RCxLQUFLM0MsR0FDWE4sSUFDQUcsR0FBUSxJQUlaYixFQUFZZCxpQkFBaUIsVUFBVTJELElBQ25DQSxFQUFFTyxpQkFDRixNQUFNUSxFQUFXM0QsRUFBYXFELE1BQzlCLEdBQWdCLE1BQVpNLEdBQWlDLEtBQWJBLEVBQWlCLE9BQ3pDLE1BQU0xQixHQWNVUCxFQWRRaUMsRUFlakIsQ0FBRXJDLEdBQUlnQyxLQUFLQyxNQUFzQixJQUFoQkQsS0FBS0UsVUFBbUJDLFdBQVkvQixLQUFNQSxFQUFNUyxVQUFVLElBRHRGLElBQW9CVCxFQWJoQjFCLEVBQWFxRCxNQUFRLEtBQ0FsRCxFQUFNMEIsTUFBS2QsR0FBUUEsRUFBS08sS0FBT2QsSUFDdkN3QixNQUFNMEIsS0FBS3pCLEdBQ3hCeEIsSUFDQUcsR0FBTyxJQXNIWEEsR0FDSixDRGhNQWdELEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9zcmMvbW9kdWxlcy9VSS5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL21vZHVsZXMvYXBwLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBmdW5jdGlvbiBkaXNwbGF5SW5wdXRzKCkge1xuXG4gICAgZnVuY3Rpb24gYWRkVGFza0J1dHRvbiAoKSB7XG5cbiAgICAgICAgY29uc3QgYWRkVGFzayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5idXR0b24tYWRkLXRhc2snKTtcbiAgICAgICAgY29uc3QgdGFza1BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFkZC10YXNrLXBvcHVwJyk7XG4gICAgICAgIGFkZFRhc2suYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICB0YXNrUG9wdXAuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgIH0pXG4gICAgXG4gICAgICAgIGNvbnN0IGNhbmNlbFBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJ1dHRvbi1jYW5jZWwtdGFzay1wb3B1cCcpO1xuICAgICAgICBjYW5jZWxQb3B1cC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgIHRhc2tQb3B1cC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICB9KVxuICAgICAgICBcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhZGRQcm9qZWN0QnV0dG9uICgpIHtcblxuICAgICAgICBjb25zdCBhZGRCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvamVjdC1idG4nKTtcbiAgICAgICAgY29uc3QgcHJvamVjdFBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2plY3RJbnB1dERpdicpO1xuICAgICAgICBhZGRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICBwcm9qZWN0UG9wdXAuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgIH0pXG5cbiAgICAgICAgY29uc3QgY2FuY2VsUHJvamVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9qZWN0LWJ1dHRvbi1jYW5jZWwnKTtcbiAgICAgICAgY2FuY2VsUHJvamVjdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgIHByb2plY3RQb3B1cC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICB9KVxuICAgIH1cblxuICAgIHJldHVybiB7IGFkZFRhc2tCdXR0b24sIGFkZFByb2plY3RCdXR0b24gfVxuICAgIFxufVxuXG5cbiIsImltcG9ydCB7IGRpc3BsYXlJbnB1dHN9IGZyb20gXCIuL21vZHVsZXMvVUlcIlxuaW1wb3J0IHsgcHJvamVjdExvZ2ljIH0gZnJvbSBcIi4vbW9kdWxlcy9hcHBcIlxuXG4vLyBBZGQgaGlkZSBwcm9qZWN0IGFuZCB0YXNrIGZvcm1zXG5kaXNwbGF5SW5wdXRzKCkuYWRkVGFza0J1dHRvbigpO1xuZGlzcGxheUlucHV0cygpLmFkZFByb2plY3RCdXR0b24oKTtcblxucHJvamVjdExvZ2ljKCk7IiwiZXhwb3J0IGZ1bmN0aW9uIHByb2plY3RMb2dpYygpIHtcbiAgICBcbiAgICBjb25zdCBsaXN0Q29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtbGlzdHNdJylcbiAgICBjb25zdCBuZXdMaXN0Rm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLW5ldy1saXN0LWZvcm1dJyk7XG4gICAgY29uc3QgbmV3TGlzdElucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtbmV3LWxpc3QtaW5wdXRdJyk7XG5cbiAgICAvLyBUYXNrcyBzaWRlIHF1ZXJ5U2VsZXRvcnNcbiAgICBjb25zdCBsaXN0RGlzcGxheUNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWxpc3QtZGlzcGxheS1jb250YWluZXJdJyk7XG4gICAgY29uc3QgbGlzdFRpdGxlRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWxpc3QtdGl0bGVdJyk7XG4gICAgY29uc3QgbGlzdENvdW50RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWxpc3QtY291bnRdJyk7XG4gICAgY29uc3QgdGFza3NDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS10YXNrc10nKTtcblxuICAgIGNvbnN0IG5ld1Rhc2tGcm9tID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtbmV3LXRhc2stZm9ybV0nKTtcbiAgICBjb25zdCBuZXdUYXNrSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1uZXctdGFzay1pbnB1dF0nKTtcblxuXG4gICAgIC8vIFJldHJpZXZlIGxpc3Qgb2Ygb2JqZWN0cyBmcm9tIGxvY2FsU3RvcmFnZSBvciBlbXB0eSBsaXN0IGlmIHRoZXJlIGlzIG5vbmVcbiAgICAgY29uc3QgTE9DQUxfU1RPUkFHRV9MSVNUX0tFWSA9ICd0YXNrLmxpc3RzJztcbiAgICAgY29uc3QgTE9DQUxfU1RPUkFHRV9TRUxFQ1RFRF9MSVNUX0lEX0tFWSA9ICd0YXNrLnNlbGVjdGVkTGlzdElkJztcbiAgICAgbGV0IGxpc3RzID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShMT0NBTF9TVE9SQUdFX0xJU1RfS0VZKSkgfHwgW107XG4gICAgIGxldCBzZWxlY3RlZExpc3RJZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKExPQ0FMX1NUT1JBR0VfU0VMRUNURURfTElTVF9JRF9LRVkpO1xuICAgICBcbiAgICAvLyBNYWtlIHNlbGVjdGVkTGlzdElkIGVxdWFsIHRvIGVhY2ggaW5kaXZpZHVhbCBsaXN0aW5nIGlkXG4gICAgbGlzdENvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGUgPT4ge1xuICAgICAgICBpZiAoZS50YXJnZXQudGFnTmFtZS50b0xvd2VyQ2FzZSgpID09PSAnbGknKSB7XG4gICAgICAgICAgICBzZWxlY3RlZExpc3RJZCA9IGUudGFyZ2V0LmRhdGFzZXQubGlzdElkO1xuICAgICAgICAgICAgc2F2ZSgpO1xuICAgICAgICAgICAgcmVuZGVyKCk7XG4gICAgICAgIH1cblxuICAgIC8vIERlbGV0ZSBzcGVjaWZpYyBwcm9qZWN0IHdoZW4gdGhlIHggaW4gaXRgcyBjb250YWluZXIgaXMgcHJlc3NlZFxuICAgICAgICBpZiAoZS50YXJnZXQudGFnTmFtZS50b0xvd2VyQ2FzZSgpID09PSAnaScpIHtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGUudGFyZ2V0LmRhdGFzZXQuZGVsZXRlTGlzdEJ1dHRvbilcbiAgICAgICAgICAgIGxpc3RzID0gbGlzdHMuZmlsdGVyKGxpc3QgPT4gbGlzdC5pZCAhPT0gZS50YXJnZXQuZGF0YXNldC5kZWxldGVMaXN0QnV0dG9uKTtcbiAgICAgICAgICAgIHNlbGVjdGVkTGlzdElkID0gbnVsbDtcbiAgICAgICAgICAgIHNhdmUoKTtcbiAgICAgICAgICAgIHJlbmRlcigpO1xuICAgICAgICB9XG4gICAgICAgIH0pXG5cbiAgICB0YXNrc0NvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGUgPT4ge1xuICAgICAgICBpZiAoZS50YXJnZXQudGFnTmFtZS50b0xvd2VyQ2FzZSgpID09PSAnaW5wdXQnKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxlY3RlZExpc3QgPSBsaXN0cy5maW5kKGxpc3QgPT4gbGlzdC5pZCA9PT0gc2VsZWN0ZWRMaXN0SWQpXG4gICAgICAgICAgICBjb25zdCBzZWxlY3RlZFRhc2sgPSBzZWxlY3RlZExpc3QudGFza3MuZmluZCh0YXNrID0+IHRhc2suaWQgPT09IGUudGFyZ2V0LmlkKVxuICAgICAgICAgICAgc2VsZWN0ZWRUYXNrLmNvbXBsZXRlID0gZS50YXJnZXQuY2hlY2tlZFxuICAgICAgICAgICAgc2F2ZSgpXG4gICAgICAgICAgICByZW5kZXJUYXNrQ291bnQoc2VsZWN0ZWRMaXN0KVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gVGFzayBkZWxldGUgYnV0dG9uXG4gICAgICAgIGlmIChlLnRhcmdldC50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdpJykge1xuICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRMaXN0ID0gbGlzdHMuZmluZChsaXN0ID0+IGxpc3QuaWQgPT09IHNlbGVjdGVkTGlzdElkKVxuICAgICAgICAgICAgc2VsZWN0ZWRMaXN0LnRhc2tzID0gc2VsZWN0ZWRMaXN0LnRhc2tzLmZpbHRlcih0YXNrID0+IHRhc2suaWQgIT09IGUudGFyZ2V0LmRhdGFzZXQuZGVsZXRlVGFza0xpc3QpXG4gICAgICAgICAgICBzYXZlKClcbiAgICAgICAgICAgIHJlbmRlcigpXG4gICAgICAgIH1cbiAgICB9KVxuXG4gICAgLy9QUk9KRUNUIEZPUk0gLSBFeHRyYWN0IHVzZXIgaW5wdXQsIGNyZWF0ZSBhIGxpc3Qgb2JqZWN0IGFuZCByZW5kZXIgaXQgdG8gdGhlIHBhZ2UgY29udGFpbmVyXG4gICAgbmV3TGlzdEZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgZSA9PiB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKVxuICAgICAgICBjb25zdCBsaXN0TmFtZSA9IG5ld0xpc3RJbnB1dC52YWx1ZTtcbiAgICAgICAgaWYgKGxpc3ROYW1lID09IG51bGwgfHwgbGlzdE5hbWUgPT09ICcnKSByZXR1cm5cbiAgICAgICAgY29uc3QgbGlzdCA9IGNyZWF0ZUxpc3QobGlzdE5hbWUpO1xuICAgICAgICBuZXdMaXN0SW5wdXQudmFsdWUgPSBudWxsO1xuICAgICAgICBsaXN0cy5wdXNoKGxpc3QpO1xuICAgICAgICBzYXZlKCk7XG4gICAgICAgIHJlbmRlcigpO1xuICAgIH0pXG5cbiAgICAvLyBUQVNLIEZPUk0gXG4gICAgbmV3VGFza0Zyb20uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgZSA9PiB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKVxuICAgICAgICBjb25zdCB0YXNrTmFtZSA9IG5ld1Rhc2tJbnB1dC52YWx1ZTtcbiAgICAgICAgaWYgKHRhc2tOYW1lID09IG51bGwgfHwgdGFza05hbWUgPT09ICcnKSByZXR1cm5cbiAgICAgICAgY29uc3QgdGFzayA9IGNyZWF0ZVRhc2sodGFza05hbWUpXG4gICAgICAgIG5ld1Rhc2tJbnB1dC52YWx1ZSA9IG51bGw7XG4gICAgICAgIGNvbnN0IHNlbGVjdGVkTGlzdCA9IGxpc3RzLmZpbmQobGlzdCA9PiBsaXN0LmlkID09PSBzZWxlY3RlZExpc3RJZClcbiAgICAgICAgc2VsZWN0ZWRMaXN0LnRhc2tzLnB1c2godGFzayk7XG4gICAgICAgIHNhdmUoKVxuICAgICAgICByZW5kZXIoKVxuICAgIH0pXG5cbiAgICAvLyBGdW5jdGlvbiB0byBjcmVhdGUgYSBsaXN0IG9iamVjdCB3aXRoIGFuIElELCBuYW1lLCBhbmQgdGFza3NcbiAgICBmdW5jdGlvbiBjcmVhdGVMaXN0KG5hbWUpIHtcbiAgICAgICAgcmV0dXJuIHsgaWQ6IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDAwMDApLnRvU3RyaW5nKCksIG5hbWU6IG5hbWUsIHRhc2tzOiBbXX1cbiAgICAgICAgLy8gRGF0ZS5ub3coKS50b1N0cmluZygpIC0gY29vbCB3YXkgdG8gZ2VuZXJhdGUgcmFuZG9tIG51bWJlciBiYXNlZCBvbiBjdXJyZW50IHRpbWVcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVUYXNrKG5hbWUpIHtcbiAgICAgICAgcmV0dXJuIHsgaWQ6IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDAwMCkudG9TdHJpbmcoKSwgbmFtZTogbmFtZSwgY29tcGxldGU6IGZhbHNlIH1cbiAgICB9XG5cblxuICAgIC8vIEZ1bmN0aW9uIHRvIHNhdmUgbGlzdCBvYmplY3RzIHRvIGxvY2FsU3RvcmFnZSAmJiBzYXZlIHNlbGVjdGVkTGlzdElkXG4gICAgZnVuY3Rpb24gc2F2ZSgpIHtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oTE9DQUxfU1RPUkFHRV9MSVNUX0tFWSwgSlNPTi5zdHJpbmdpZnkobGlzdHMpKTtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oTE9DQUxfU1RPUkFHRV9TRUxFQ1RFRF9MSVNUX0lEX0tFWSwgc2VsZWN0ZWRMaXN0SWQpO1xuICAgIH1cblxuXG4gICAgZnVuY3Rpb24gcmVuZGVyKCkge1xuICAgICAgICBjbGVhckVsZW1lbnQobGlzdENvbnRhaW5lcilcbiAgICAgICAgcmVuZGVyTGlzdCgpXG5cbiAgICAgICAgIC8vIEV4dHJhY3QgbGlzdCBkZXRhaWxzIG9mIHRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgbGlzdFxuICAgICAgICAgY29uc3Qgc2VsZWN0ZWRMaXN0ID0gbGlzdHMuZmluZChsaXN0ID0+IGxpc3QuaWQgPT09IHNlbGVjdGVkTGlzdElkKVxuXG4gICAgICAgICBpZiAoIHNlbGVjdGVkTGlzdElkID09IG51bGwpIHtcbiAgICAgICAgICAgICBsaXN0RGlzcGxheUNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnXG4gICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgIGxpc3REaXNwbGF5Q29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnJ1xuICAgICAgICAgICAgIGxpc3RUaXRsZUVsZW1lbnQuaW5uZXJUZXh0ID0gc2VsZWN0ZWRMaXN0Lm5hbWVcbiAgICAgICAgICAgICByZW5kZXJUYXNrQ291bnQoc2VsZWN0ZWRMaXN0KVxuICAgICAgICAgICAgIGNsZWFyRWxlbWVudCh0YXNrc0NvbnRhaW5lcilcbiAgICAgICAgICAgICByZW5kZXJUYXNrcyhzZWxlY3RlZExpc3QpXG4gICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVuZGVyVGFza3Moc2VsZWN0ZWRMaXN0KSB7XG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRMaXN0LnRhc2tzLmZvckVhY2godGFzayA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgdGFza0RpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgICAgICAgICAgICAgdGFza0Rpdi5jbGFzc0xpc3QuYWRkKCd0YXNrLWJ1dHRvbicpXG5cbiAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgIC8vIERpc3BsYXkgb24gaHRtbCBjaGVja2VkIGJveCBjaGVja2VkIGFmdGVyIHJlZnJlc2hpbmcgcGFnZVxuICAgICAgICAgICAgICAgIGlmICh0YXNrLmNvbXBsZXRlID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoZWNrQm94ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFzay5pZClcbiAgICAgICAgICAgICAgICAgICAgdGFza0Rpdi5pbm5lckhUTUwgPSBgXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJsZWZ0U2lkZS10YXNrXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IGNsYXNzPVwiY2hlY2tJdFwiIHR5cGU9XCJjaGVja2JveFwiIGNoZWNrZWQ9dHJ1ZSBpZD0ke3Rhc2suaWR9IGRhdGEtY2hlY2stYm94PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzPVwidGFzay1jb250ZW50XCI+JHt0YXNrLm5hbWV9PC9wPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIGNsYXNzPVwiaW5wdXQtdGFzay1uYW1lXCIgZGF0YS1pbnB1dC10YXNrLW5hbWU+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInJpZ2h0U2lkZS10YXNrXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3M9XCJkdWUtZGF0ZVwiIGlkPVwiZHVlLWRhdGVcIj48L3A+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJkYXRlXCIgY2xhc3M9XCJpbnB1dC1kdWUtZGF0ZVwiIGRhdGEtaW5wdXQtZHVlLWRhdGU+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9XCJmYSBmYS10aW1lcyB4VGFza1wiIGRhdGEtZGVsZXRlLXRhc2stbGlzdD0ke3Rhc2suaWR9IGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICBgO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0YXNrRGl2LmlubmVySFRNTCA9IGBcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImxlZnRTaWRlLXRhc2tcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgY2xhc3M9XCJjaGVja0l0XCIgdHlwZT1cImNoZWNrYm94XCIgaWQ9JHt0YXNrLmlkfSBkYXRhLWNoZWNrLWJveD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzcz1cInRhc2stY29udGVudFwiPiR7dGFzay5uYW1lfTwvcD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIiBjbGFzcz1cImlucHV0LXRhc2stbmFtZVwiIGRhdGEtaW5wdXQtdGFzay1uYW1lPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwicmlnaHRTaWRlLXRhc2tcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzcz1cImR1ZS1kYXRlXCIgaWQ9XCJkdWUtZGF0ZVwiPjwvcD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cImRhdGVcIiBjbGFzcz1cImlucHV0LWR1ZS1kYXRlXCIgZGF0YS1pbnB1dC1kdWUtZGF0ZT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz1cImZhIGZhLXRpbWVzIHhUYXNrXCIgZGF0YS1kZWxldGUtdGFzay1saXN0PSR7dGFzay5pZH0gYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9pPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIGA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHRhc2tzQ29udGFpbmVyLmFwcGVuZENoaWxkKHRhc2tEaXYpXG4gICAgICAgICAgICAgfSlcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZW5kZXJUYXNrQ291bnQoc2VsZXRlZExpc3QpIHtcbiAgICAgICAgY29uc3QgaW5jb21wbGV0ZVRhc2tDb3VudCA9IHNlbGV0ZWRMaXN0LnRhc2tzLmZpbHRlcih0YXNrID0+ICF0YXNrLmNvbXBsZXRlKS5sZW5ndGhcbiAgICAgICAgbGlzdENvdW50RWxlbWVudC5pbm5lclRleHQgPSBpbmNvbXBsZXRlVGFza0NvdW50XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVuZGVyTGlzdCgpIHtcbiAgICAgICAgbGlzdHMuZm9yRWFjaChsaXN0ID0+IHtcblxuICAgICAgICAgICAgY29uc3QgbGlzdEVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpOyAvLyBDcmVhdGUgbGlzdCBlbGVtZW50XG4gICAgICAgICAgICBjb25zdCBkZWxCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpJyk7IC8vIENyZWF0ZSBYIChkZWxldGUpIGJ1dHRvbiBvbiBlYWNoIGxpc3QgZWxlbVxuXG4gICAgICAgICAgICBkZWxCdXR0b24uY2xhc3NMaXN0LmFkZCgnZmEnLCAnZmEtdGltZXMnLCAneFByb2plY3QnKTsgLy8gQWRkIGNsYXNzIHRvIGVhY2ggZGVsZXRlIGJ1dHRvblxuICAgICAgICAgICAgZGVsQnV0dG9uLnNldEF0dHJpYnV0ZSgnZGF0YS1kZWxldGUtbGlzdC1idXR0b24nLCBsaXN0LmlkKTsgLy8gU2V0IGRhdGEgYXR0cmlidXRlIG9uIGVhY2ggZGVsIGJ0blxuXG4gICAgICAgICAgICBsaXN0RWxlbWVudC5kYXRhc2V0Lmxpc3RJZCA9IGxpc3QuaWQ7IC8vIFNldCBkYXRhLWlkID09IHJhbmRvbSBnZW5lcmF0ZWQgaWRcbiAgICAgICAgICAgIGxpc3RFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2J1dHRvbi1wcm9qZWN0Jyk7XG4gICAgICAgICAgICBsaXN0RWxlbWVudC5pbm5lckhUTUwgPSBgPGkgY2xhc3M9XCJmYSBmYS10YXNrc1wiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT4ke2xpc3QubmFtZX1gXG4gICAgICAgICAgICBpZiAobGlzdC5pZCA9PT0gc2VsZWN0ZWRMaXN0SWQpIHtcbiAgICAgICAgICAgICAgICBsaXN0RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdhY3RpdmUtbGlzdCcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsaXN0RWxlbWVudC5hcHBlbmRDaGlsZChkZWxCdXR0b24pO1xuICAgICAgICAgICAgbGlzdENvbnRhaW5lci5hcHBlbmRDaGlsZChsaXN0RWxlbWVudCk7XG5cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2xlYXJFbGVtZW50KGVsZW1lbnQpIHtcbiAgICAgICAgd2hpbGUgKGVsZW1lbnQuZmlyc3RDaGlsZCkge1xuICAgICAgICAgICAgZWxlbWVudC5yZW1vdmVDaGlsZChlbGVtZW50LmZpcnN0Q2hpbGQpO1xuICAgICAgICB9XG4gICAgfVxuXG5cblxuICAgIHJlbmRlcigpO1xufVxuIl0sIm5hbWVzIjpbImRpc3BsYXlJbnB1dHMiLCJhZGRUYXNrQnV0dG9uIiwiYWRkVGFzayIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInRhc2tQb3B1cCIsImFkZEV2ZW50TGlzdGVuZXIiLCJzdHlsZSIsImRpc3BsYXkiLCJhZGRQcm9qZWN0QnV0dG9uIiwiYWRkQnRuIiwiZ2V0RWxlbWVudEJ5SWQiLCJwcm9qZWN0UG9wdXAiLCJsaXN0Q29udGFpbmVyIiwibmV3TGlzdEZvcm0iLCJuZXdMaXN0SW5wdXQiLCJsaXN0RGlzcGxheUNvbnRhaW5lciIsImxpc3RUaXRsZUVsZW1lbnQiLCJsaXN0Q291bnRFbGVtZW50IiwidGFza3NDb250YWluZXIiLCJuZXdUYXNrRnJvbSIsIm5ld1Rhc2tJbnB1dCIsIkxPQ0FMX1NUT1JBR0VfTElTVF9LRVkiLCJMT0NBTF9TVE9SQUdFX1NFTEVDVEVEX0xJU1RfSURfS0VZIiwibGlzdHMiLCJKU09OIiwicGFyc2UiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwic2VsZWN0ZWRMaXN0SWQiLCJzYXZlIiwic2V0SXRlbSIsInN0cmluZ2lmeSIsInJlbmRlciIsImNsZWFyRWxlbWVudCIsImZvckVhY2giLCJsaXN0IiwibGlzdEVsZW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiZGVsQnV0dG9uIiwiY2xhc3NMaXN0IiwiYWRkIiwic2V0QXR0cmlidXRlIiwiaWQiLCJkYXRhc2V0IiwibGlzdElkIiwiaW5uZXJIVE1MIiwibmFtZSIsImFwcGVuZENoaWxkIiwic2VsZWN0ZWRMaXN0IiwiZmluZCIsImlubmVyVGV4dCIsInJlbmRlclRhc2tDb3VudCIsInRhc2tzIiwidGFzayIsInRhc2tEaXYiLCJjb21wbGV0ZSIsInJlbmRlclRhc2tzIiwic2VsZXRlZExpc3QiLCJpbmNvbXBsZXRlVGFza0NvdW50IiwiZmlsdGVyIiwibGVuZ3RoIiwiZWxlbWVudCIsImZpcnN0Q2hpbGQiLCJyZW1vdmVDaGlsZCIsImUiLCJ0YXJnZXQiLCJ0YWdOYW1lIiwidG9Mb3dlckNhc2UiLCJkZWxldGVMaXN0QnV0dG9uIiwiY2hlY2tlZCIsImRlbGV0ZVRhc2tMaXN0IiwicHJldmVudERlZmF1bHQiLCJsaXN0TmFtZSIsInZhbHVlIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwidG9TdHJpbmciLCJwdXNoIiwidGFza05hbWUiLCJwcm9qZWN0TG9naWMiXSwic291cmNlUm9vdCI6IiJ9